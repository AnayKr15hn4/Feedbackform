<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pitch Deck Feedback</title>
  <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/1388/1388393.png">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      background: #1d1d1d;
      padding: 40px 20px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    h1 {
      font-size: 48px;
      font-weight: 700;
      color: white;
      margin-bottom: 40px;
      letter-spacing: -1px;
    }

    .section {
      background: #2a2a2a;
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      border: 2px solid #3a3a3a;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    h2 {
      color: #a4c2f4;
      font-size: 28px;
      font-weight: 600;
      margin: 0;
    }

    .field {
      margin-bottom: 25px;
    }

    .field:last-child {
      margin-bottom: 0;
    }

    label {
      display: block;
      color: #f6f5ec;
      font-size: 16px;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .rating-container {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    input[type="range"] {
      flex: 1;
      height: 8px;
      border-radius: 4px;
      background: #3a3a3a;
      outline: none;
      accent-color: #a4c2f4;
    }

    .rating-value {
      color: #a4c2f4;
      font-size: 24px;
      font-weight: 700;
      min-width: 40px;
    }

    textarea {
      width: 100%;
      background: #1d1d1d;
      border: 2px solid #3a3a3a;
      border-radius: 12px;
      padding: 15px;
      color: white;
      font-size: 15px;
      font-family: inherit;
      resize: vertical;
      outline: none;
    }

    textarea:focus {
      border-color: #a4c2f4;
    }

    select {
      width: 100%;
      background: #2a2a2a;
      border: 2px solid #3a3a3a;
      border-radius: 12px;
      padding: 12px 15px;
      color: white;
      font-size: 15px;
      font-family: inherit;
      outline: none;
      cursor: pointer;
    }

    select:focus {
      border-color: #a4c2f4;
    }

    select option {
      color: white;
    }

    .person-card {
      background: #1d1d1d;
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 20px;
      border: 2px solid #3a3a3a;
      position: relative;
    }

    .person-card textarea {
      background: #2a2a2a;
    }

    .btn {
      border: none;
      border-radius: 12px;
      padding: 12px 20px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #a4c2f4;
      color: #1d1d1d;
    }

    .btn-primary:hover {
      background: #8fb3f0;
    }

    .btn-delete {
      position: absolute;
      top: 15px;
      right: 15px;
      background: transparent;
      color: #f6f5ec;
      padding: 8px;
      border-radius: 8px;
    }

    .btn-delete:hover {
      background: #3a3a3a;
      color: #ff6b6b;
    }

    .btn-submit {
      width: 100%;
      border-radius: 16px;
      padding: 18px;
      font-size: 18px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: all 0.3s;
      text-align: center;
    }

    .btn-submit:disabled {
      background: #555;
      color: #888;
      cursor: not-allowed;
      opacity: 0.6;
    }

    .btn-submit:not(:disabled):hover {
      background: #8fb3f0;
    }

    .status-message {
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 20px;
      text-align: center;
      font-weight: 600;
      color: white;
    }

    .status-success {
      background: #4caf50;
    }

    .status-error {
      background: #f44336;
    }

    .icon {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Pitch Deck Feedback</h1>

    <form id="feedbackForm" action="https://formspree.io/f/mqezrkyp" method="POST">
      <!-- General Feedback Section -->
      <div class="section">
        <h2>General Feedback</h2>

        <div class="field">
          <label>Overall Rating</label>
          <div class="rating-container">
            <input type="range" min="1" max="10" value="5" id="overallRating" name="overallRating">
            <span class="rating-value" id="ratingValue">5</span>
          </div>
        </div>

        <div class="field">
          <label>What did we do well?</label>
          <textarea id="generalDidWell" name="generalDidWell" rows="4" placeholder="Share what impressed you..."></textarea>
        </div>

        <div class="field">
          <label>What needs improvement?</label>
          <textarea id="generalNeedsImprovement" name="generalNeedsImprovement" rows="4" placeholder="Share constructive feedback..."></textarea>
        </div>
      </div>

      <!-- Individual Feedback Section -->
      <div class="section">
        <div class="section-header">
          <h2>Individual Feedback</h2>
          <button type="button" class="btn btn-primary" onclick="addPersonFeedback()">
            <svg class="icon" viewBox="0 0 24 24">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Person
          </button>
        </div>

        <div id="personFeedbackContainer"></div>
      </div>

      <!-- Hidden field for individual feedback JSON -->
      <input type="hidden" id="individualFeedbackJSON" name="individualFeedback">

      <!-- Status Messages -->
      <div id="statusMessage"></div>

      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary btn-submit" id="submitBtn">
        Submit Feedback
      </button>
    </form>
  </div>

  <script>
    // Presenter names
    const presenterNames = [
      'Anay K',
      'Eshaan R',
      'Team Member 3',
      'Team Member 4',
      'Team Member 5'
    ];

    // State
    let personFeedback = [
      { id: Date.now(), name: '', didWell: '', needsImprovement: '' }
    ];

    // Initialize
    function init() {
      // Setup rating slider
      const ratingSlider = document.getElementById('overallRating');
      const ratingValue = document.getElementById('ratingValue');
      ratingSlider.addEventListener('input', (e) => {
        ratingValue.textContent = e.target.value;
        updateSubmitButton();
      });

      // Setup general feedback listeners
      document.getElementById('generalDidWell').addEventListener('input', updateSubmitButton);
      document.getElementById('generalNeedsImprovement').addEventListener('input', updateSubmitButton);

      // Render initial person feedback
      renderPersonFeedback();
    }

    // Render person feedback cards
    function renderPersonFeedback() {
      const container = document.getElementById('personFeedbackContainer');
      container.innerHTML = '';

      personFeedback.forEach((person, index) => {
        const card = document.createElement('div');
        card.className = 'person-card';
        card.innerHTML = `
          ${personFeedback.length > 1 ? `
            <button type="button" class="btn btn-delete" onclick="removePersonFeedback(${person.id})">
              <svg class="icon" viewBox="0 0 24 24">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              </svg>
            </button>
          ` : ''}

          <div class="field">
            <label>Person Name</label>
            <select id="person-name-${person.id}" name="person_${index}_name" onchange="updatePersonField(${person.id}, 'name', this.value)">
              <option value="">Select a presenter...</option>
              ${presenterNames.map(name => 
                `<option value="${name}" ${person.name === name ? 'selected' : ''}>${name}</option>`
              ).join('')}
            </select>
          </div>

          <div class="field">
            <label>What did they do well?</label>
            <textarea id="person-didWell-${person.id}" name="person_${index}_didWell" rows="3" placeholder="Their strengths..." onkeyup="updatePersonField(${person.id}, 'didWell', this.value)">${person.didWell}</textarea>
          </div>

          <div class="field">
            <label>What could they improve?</label>
            <textarea id="person-needsImprovement-${person.id}" name="person_${index}_needsImprovement" rows="3" placeholder="Areas for growth..." onkeyup="updatePersonField(${person.id}, 'needsImprovement', this.value)">${person.needsImprovement}</textarea>
          </div>
        `;
        container.appendChild(card);
      });

      updateSubmitButton();
    }

    // Add person feedback
    function addPersonFeedback() {
      personFeedback.unshift({
        id: Date.now(),
        name: '',
        didWell: '',
        needsImprovement: ''
      });
      renderPersonFeedback();
    }

    // Remove person feedback
    function removePersonFeedback(id) {
      if (personFeedback.length > 1) {
        personFeedback = personFeedback.filter(person => person.id !== id);
        renderPersonFeedback();
      }
    }

    // Update person field
    function updatePersonField(id, field, value) {
      const person = personFeedback.find(p => p.id === id);
      if (person) {
        person[field] = value;
        updateSubmitButton();
      }
    }

    // Check if form is valid
    function isFormValid() {
      const generalDidWell = document.getElementById('generalDidWell').value;
      const generalNeedsImprovement = document.getElementById('generalNeedsImprovement').value;

      if (generalDidWell || generalNeedsImprovement) return true;

      for (const person of personFeedback) {
        if (person.name || person.didWell || person.needsImprovement) return true;
      }

      return false;
    }

    // Update submit button state
    function updateSubmitButton() {
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = !isFormValid();
    }

    // Handle form submission
    function handleSubmit(e) {
      e.preventDefault();
      
      if (!isFormValid()) {
        return false;
      }

      // Disable submit button to prevent double submission
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';

      // Create FormData object
      const form = document.getElementById('feedbackForm');
      const formData = new FormData(form);

      // Add individual feedback as JSON
      formData.set('individualFeedback', JSON.stringify(personFeedback));

      // Submit using fetch with proper error handling
      fetch('https://formspree.io/f/mqezrkyp', {
        method: 'POST',
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      })
      .then(response => {
        if (response.ok) {
          // Reset form
          form.reset();
          document.getElementById('overallRating').value = 5;
          document.getElementById('ratingValue').textContent = 5;
          personFeedback = [{ id: Date.now(), name: '', didWell: '', needsImprovement: '' }];
          renderPersonFeedback();
          
          // Show success message
          alert('âœ“ Feedback submitted successfully! Thank you!');
        } else {
          response.json().then(data => {
            if (data.errors) {
              alert('Error: ' + data.errors.map(error => error.message).join(', '));
            } else {
              alert('Failed to submit. Please try again.');
            }
          });
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('Failed to submit. Please check your connection and try again.');
      })
      .finally(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Feedback';
        updateSubmitButton();
      });

      return false;
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', () => {
      init();
      
      // Add form submit handler
      const form = document.getElementById('feedbackForm');
      form.addEventListener('submit', handleSubmit);
    });
  </script>
</body>
</html>
